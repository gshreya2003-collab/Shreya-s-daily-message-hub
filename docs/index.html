<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daily Oracle • Tarot Stone</title>

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fbfaf8;
      --card:#fff;
      --ink:#2b2430;
      --accent:#c85f2a;   /* saffron-like */
      --deep:#2b2350;     /* indigo */
      --leaf:#2a6f4a;
      --muted:#8c8192;
      --glass: rgba(255,255,255,0.7);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:"Poppins",sans-serif;
      background:
        radial-gradient(circle at 10% 10%, #faf6ff 0%, var(--bg) 40%),
        repeating-linear-gradient(135deg, rgba(0,0,0,0.01) 0 2px, transparent 2px 10px);
      color:var(--ink);
      -webkit-font-smoothing:antialiased;
      padding:20px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .wrap{
      width:100%;
      max-width:980px;
      background:linear-gradient(180deg,rgba(255,255,255,0.96),rgba(253,252,255,0.99));
      border-radius:16px;
      padding:22px;
      box-shadow: 0 30px 60px rgba(40,30,80,0.07);
      position:relative;
      overflow:hidden;
      border:1px solid rgba(30,20,40,0.03);
    }

    /* header decorative */
    .banner {
      position:absolute; left:-10%; right:-10%; top:-24px; height:120px;
      background: linear-gradient(90deg, rgba(45,34,75,0.06), rgba(200,95,40,0.02));
      clip-path: polygon(0 0, 100% 0, 100% 70%, 0 88%);
      pointer-events:none;
      opacity:0.95;
    }

    header {
      display:flex; gap:16px; align-items:center; margin-bottom:8px;
    }
    .logo {
      width:68px;height:68px;border-radius:12px;
      background:linear-gradient(180deg,#fffefc,#f6f1ff);
      display:flex;align-items:center;justify-content:center;
      font-family:"Merriweather",serif;color:var(--deep); font-size:30px;
      box-shadow: inset 0 -8px 20px rgba(0,0,0,0.03);
    }
    h1{margin:0;font-family:"Merriweather",serif;font-weight:700;color:var(--deep);letter-spacing:0.2px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .grid { display:grid; grid-template-columns: 1fr 340px; gap:18px; align-items:start; }
    @media (max-width:860px){ .grid{grid-template-columns:1fr} }

    /* left card */
    .card {
      background:var(--card); border-radius:12px; padding:16px; box-shadow:0 10px 30px rgba(40,30,70,0.04); border:1px solid rgba(80,60,120,0.02);
    }

    .stone-row { display:flex; gap:12px; align-items:center; }
    .stone-box {
      width:140px; height:140px; border-radius:18px;
      background: linear-gradient(180deg,#fff #f4f1ff);
      display:flex;align-items:center;justify-content:center;
      box-shadow: 0 12px 26px rgba(60,40,80,0.06);
      position:relative;
    }
    .stone-core {
      width:96px;height:96px;border-radius:50%;
      background:linear-gradient(180deg,#fbf8ff,#efe6ff);
      display:flex;align-items:center;justify-content:center;
      font-family:"Merriweather",serif;color:var(--deep); font-weight:700; font-size:32px;
      box-shadow: inset 0 -8px 18px rgba(0,0,0,0.03);
    }

    .controls { display:flex; gap:10px; margin-top:6px; flex-wrap:wrap }
    .btn {
      background:var(--accent); color:#fff; padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:600;
      box-shadow: 0 8px 22px rgba(200,80,30,0.12);
    }
    .btn.ghost { background:transparent; color:var(--deep); border:1px solid rgba(60,40,80,0.06); box-shadow:none }

    #result {
      margin-top:16px; min-height:190px; padding:18px; border-radius:12px; background:linear-gradient(180deg,#fff,#fbfbff);
      border:1px solid rgba(100,80,150,0.03); display:flex; align-items:center; justify-content:center; flex-direction:column;
    }
    .blessing { font-family:"Merriweather", serif; color:var(--deep); font-size:20px; text-align:center; line-height:1.5; white-space:pre-wrap; margin:0; padding:0 8px }
    .meta { margin-top:12px; color:var(--muted); font-size:13px }

    /* right panel with motifs */
    .aside {
      display:flex; flex-direction:column; gap:12px;
    }
    .motif {
      border-radius:12px; padding:12px; background:linear-gradient(180deg,#fff,#fbfbff); border:1px solid rgba(80,60,120,0.02);
    }
    .motif h3 { margin:0 0 8px 0; font-size:14px; color:var(--deep) }
    .motif p { margin:0; color:var(--muted); font-size:13px }

    .ornament { display:flex; gap:8px; align-items:center; margin-top:8px }
    .ornament svg { width:44px; height:44px; opacity:0.9 }

    /* footer */
    footer { margin-top:14px; text-align:center; color:var(--muted); font-size:13px }

    /* small screens safety */
    @media (max-width:520px){
      .stone-core{font-size:26px;width:78px;height:78px}
      .btn{padding:8px 10px}
    }

    /* subtle mandala top-right */
    .mandala {
      position:absolute; right:-40px; top:-40px; width:260px; opacity:0.06; transform:rotate(10deg);
    }

    /* decorative skyline strip bottom */
    .skyline {
      position:absolute; left:0; right:0; bottom:0; height:32px; background:
      linear-gradient(180deg, rgba(255,255,255,0), rgba(245,245,247,0.6));
      display:block; pointer-events:none;
    }

  </style>
</head>
<body>
  <div class="wrap" role="main">
    <div class="banner" aria-hidden="true"></div>
    <!-- subtle mandala -->
    <svg class="mandala" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <g fill="#2b2350"><path d="M100 2 L116 40 L158 44 L126 70 L136 110 L100 90 L64 110 L74 70 L42 44 L84 40 Z"></path></g>
    </svg>

    <header>
      <div class="logo">ॐ</div>
      <div>
        <h1>Daily Oracle</h1>
        <p class="lead">Indo-Western • Singapore nature • handcrafted reveals. Tap your Blessing Stone or press Reveal for one random item from the oracle.</p>
      </div>
    </header>

    <div class="grid">
      <!-- left -->
      <div class="card">
        <div class="stone-row">
          <div class="stone-box" aria-hidden="true"><div class="stone-core">ॐ</div></div>

          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:start;gap:12px;flex-wrap:wrap">
              <div>
                <div style="font-weight:700;color:var(--deep)">Your personal oracle</div>
                <div style="color:var(--muted);font-size:13px;margin-top:6px">Each reveal draws from your curated collection (text, poem, fortune, quote, memory, image, or audio).</div>
              </div>
              <div style="display:flex;gap:8px">
                <button id="reveal" class="btn">Reveal</button>
                <button id="newOne" class="btn ghost">Another</button>
                <button id="last" class="btn ghost">Show last</button>
              </div>
            </div>

            <div id="result" aria-live="polite">
              <div id="contentArea"><p style="color:var(--muted)">Tap Reveal to draw a blessing from the Daily Oracle.</p></div>
            </div>

            <div style="margin-top:12px;color:var(--muted);font-size:13px">Tip: For audio, visitors must tap play on phones. To update content, edit the data JSON in <code>docs/data/blessings.json</code>.</div>
          </div>
        </div>
      </div>

      <!-- right -->
      <aside class="aside">
        <div class="motif">
          <h3>Design accents</h3>
          <p>Orchid and mandala motifs, batik-inspired texture, and a subtle Singapore skyline strip — all combined with Indian linework for an Indo-Western look.</p>
          <div class="ornament">
            <!-- small orchid icon -->
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#c45f2a" d="M12 2s2.5 2 3 4c0 0 1.8 0 2 1s-1 1-1 1 1 1 1 2-1 1-1 1-1.2 0-2 1-1.5 3-2.5 3-1.5-1.5-2-2-1.3-1-2-1-1 1-2 1-1.2-3-2.5-3-2 0-2-1 1-2 1-2-1-1-1-1 1-1 2-1 2 1 2 1 1-2 3-4 3 0 3 0z"/></svg>

            <!-- simple skyline -->
            <svg viewBox="0 0 80 24" xmlns="http://www.w3.org/2000/svg"><g fill="#2b2350"><rect x="2" y="8" width="4" height="12"/><rect x="8" y="4" width="3" height="16"/><rect x="12" y="10" width="3" height="10"/><rect x="16" y="2" width="4" height="18"/><rect x="22" y="12" width="3" height="8"/></g></svg>
          </div>
        </div>

        <div class="motif">
          <h3>Content scale</h3>
          <p class="sample">This oracle reads from an external JSON file so you can store hundreds (or thousands) of reveals without editing the HTML every time.</p>
        </div>

        <div class="motif">
          <h3>Site URL</h3>
          <div id="siteurl" style="font-weight:700;color:var(--deep);margin-top:8px"></div>
          <div style="margin-top:8px;color:var(--muted);font-size:13px">Use this URL as the NFC tag link for your Blessing Stones.</div>
        </div>
      </aside>
    </div>

    <footer>Built for your Blessing Stone • Daily Oracle</footer>

    <div class="skyline" aria-hidden="true"></div>
  </div>

  <script>
    /* =========
       Script loads large JSON from docs/data/blessings.json
       JSON structure: array of items
       item = { type: "text"|"fortune"|"poem"|"quote"|"memory"|"audio"|"image", content: "string", src: "url", label: "string (optional)" }
       Example:
         { "type":"fortune", "content":"A small kindness will return to you." }
         { "type":"audio", "src":"https://docs.google.com/uc?export=download&id=FILEID", "label":"A soft voice" }
    ========== */

    const DATA_URL = './data/blessings.json'; // path relative to docs/index.html

    let items = [];
    let lastIdx = null;

    // fetch JSON and enable UI
    async function loadData(){
      try {
        const res = await fetch(DATA_URL + '?v=' + (Date.now())); // cache-bust while editing
        if(!res.ok) throw new Error('Data not found: ' + res.status);
        items = await res.json();
        console.log('Loaded', items.length, 'items');
        // optional auto reveal a random item on load:
        // revealRandom();
      } catch (err){
        console.error(err);
        const box = document.getElementById('contentArea');
        box.innerHTML = '<p style="color:#b44">Could not load blessings data. Make sure <code>docs/data/blessings.json</code> exists.</p>';
      }
    }

    function pickRandomIdx(last){
      if(!items || items.length === 0) return -1;
      if(items.length === 1) return 0;
      let i;
      do { i = Math.floor(Math.random() * items.length); } while(items.length>1 && i === last);
      return i;
    }

    function renderItem(i){
      const box = document.getElementById('contentArea');
      box.innerHTML = '';
      if(i < 0) { box.innerHTML = '<p style="color:var(--muted)">No blessings yet. Add reveals to docs/data/blessings.json</p>'; return; }
      const it = items[i];
      if(!it) { box.innerHTML = '<p style="color:var(--muted)">Invalid item</p>'; return; }

      if(it.type === 'audio'){
        const title = document.createElement('div'); title.className='meta'; title.innerText = it.label || 'Audio Blessing';
        const audio = document.createElement('audio'); audio.controls = true; audio.src = it.src; audio.setAttribute('playsinline','');
        audio.setAttribute('preload','none'); // avoid heavy downloads
        box.appendChild(title); box.appendChild(audio);
        const hint = document.createElement('div'); hint.className='meta'; hint.innerText = 'Tap play to hear the blessing.';
        box.appendChild(hint);
      } else if(it.type === 'image'){
        const img = document.createElement('img'); img.src = it.src; img.alt = it.label || 'image'; img.style.maxWidth='92%'; img.style.borderRadius='10px';
        box.appendChild(img);
        if(it.label){ const cap = document.createElement('div'); cap.className='meta'; cap.innerText = it.label; box.appendChild(cap); }
      } else {
        const p = document.createElement('p'); p.className='blessing'; p.innerText = it.content || it.text || '';
        box.appendChild(p);
        const meta = document.createElement('div'); meta.className='meta'; meta.innerText = (it.type || 'Text').charAt(0).toUpperCase() + (it.type || 'Text').slice(1);
        box.appendChild(meta);
      }
    }

    document.getElementById('reveal').addEventListener('click', ()=>{
      const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
    });
    document.getElementById('newOne').addEventListener('click', ()=>{
      const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
    });
    document.getElementById('last').addEventListener('click', ()=>{ if(lastIdx !== null) renderItem(lastIdx); });

    // show site url for convenient NFC copying
    (function(){ const site = location.origin + location.pathname.replace(/\/index\.html$/,''); document.getElementById('siteurl').innerText = site; })();

    // load data immediately
    loadData();

  </script>
</body>
</html>
