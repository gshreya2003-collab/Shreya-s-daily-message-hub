<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily Oracle — Blessing Stone</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Nunito:wght@300;400;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#fffaf8;
  --card:#fff;
  --ink:#2b2430;
  --gold1: #d8a34a;
  --gold2: #f4c66a;
  --accent:#e07f3a; /* saffron */
  --leaf:#2a6f4a;
  --muted:#7f7483;
  --shadow: 0 22px 50px rgba(40,30,70,0.08);
  --soft: rgba(30,20,50,0.04);
}

/* subtle batik-like repeating pattern using SVG data image */
body{
  margin:0;
  font-family: "Nunito", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color:var(--ink);
  background:
    radial-gradient(circle at 8% 12%, rgba(255,250,246,1) 0%, rgba(255,250,246,0.9) 30%),
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><defs><pattern id="p" patternUnits="userSpaceOnUse" width="80" height="80"><g fill="%23efe7f6"><path d="M0 40c20-20 40-20 60 0" stroke="%23efe7f6" stroke-width="6" fill="none"/></g></pattern></defs><rect width="100%" height="100%" fill="url(%23p)"/></svg>') ;
  background-size:cover;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  display:flex;align-items:center;justify-content:center;padding:26px;
  min-height:100vh;
}

/* main card */
.wrap{
  width:100%; max-width:1024px; border-radius:18px; padding:26px;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,250,245,0.98));
  box-shadow:var(--shadow); border:1px solid rgba(40,30,80,0.03);
  position:relative; overflow:hidden;
}

/* gold foil header strip with batik linework */
.header-strip{
  position:absolute; left:-10%; right:-10%; top:-50px; height:160px;
  background-image: linear-gradient(90deg, rgba(45,34,75,0.04), rgba(240,180,90,0.04)), radial-gradient(circle at 70% 30%, rgba(255,240,220,0.35), transparent 40%);
  clip-path: polygon(0 0, 100% 0, 100% 60%, 0 82%);
  pointer-events:none;
  opacity:0.95;
}

/* top ornament (orchid petals) */
.orchid{
  position:absolute; right:12px; top:8px; width:220px; opacity:0.10; transform:rotate(-8deg); pointer-events:none;
}

/* header */
.header{display:flex;gap:14px;align-items:center;margin-bottom:10px}
.logo{
  width:80px;height:80px;border-radius:14px;display:flex;align-items:center;justify-content:center;
  background:linear-gradient(180deg,#fffaf6,#fff4ee); font-family:"Playfair Display", serif; font-size:34px; color:var(--gold1);
  box-shadow: inset 0 -10px 24px rgba(0,0,0,0.03)
}
.title h1{margin:0;font-family:"Playfair Display",serif;font-weight:700;font-size:26px;color:var(--ink)}
.title p{margin:0;color:var(--muted);font-size:14px}

/* layout grid */
.grid{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
@media (max-width:900px){ .grid{grid-template-columns:1fr} }

/* left card */
.card{background:var(--card);border-radius:14px;padding:18px;border:1px solid rgba(120,100,160,0.02);box-shadow:0 10px 36px var(--soft);position:relative;overflow:visible}
.stone-row{display:flex;gap:16px;align-items:flex-start}
.stone-box{width:150px;height:150px;border-radius:18px;background:linear-gradient(180deg,#fffefc,#fff6f0);display:flex;align-items:center;justify-content:center;box-shadow:0 18px 40px rgba(40,30,60,0.06)}
.stone-core{width:102px;height:102px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:"Playfair Display",serif;color:var(--gold1);font-weight:700;font-size:34px;background:linear-gradient(180deg,#fff8f0,#fff0e6);box-shadow:inset 0 -10px 20px rgba(0,0,0,0.04)}

.controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;align-items:center}
.btn{
  background: linear-gradient(180deg,var(--gold1),var(--gold2));
  color:#2b2430;border:0;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 12px 28px rgba(200,120,40,0.14);
  transition:transform .12s ease, box-shadow .12s ease;
}
.btn:hover{transform:translateY(-4px);box-shadow:0 18px 36px rgba(200,120,40,0.18)}
.btn.ghost{background:transparent;border:1px solid rgba(40,30,60,0.06);color:var(--ink);box-shadow:none}

/* result area */
#result{margin-top:14px;min-height:220px;padding:20px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffaf6);border:1px solid rgba(200,180,220,0.04);display:flex;align-items:center;justify-content:center;flex-direction:column;box-shadow:0 6px 18px rgba(20,10,30,0.02)}
.blessing{font-family:"Playfair Display",serif;color:var(--ink);font-size:20px;line-height:1.55;text-align:center;margin:0;padding:0 8px;white-space:pre-wrap}
.meta{margin-top:12px;color:var(--muted);font-size:13px}

/* right column motifs */
.aside{display:flex;flex-direction:column;gap:12px}
.motif{border-radius:12px;padding:12px;background:linear-gradient(180deg,#fff,#fffefc);border:1px solid rgba(120,100,160,0.02);box-shadow:0 8px 20px rgba(20,10,40,0.03)}
.motif h3{margin:0 0 8px 0;font-family:"Playfair Display",serif;color:var(--ink);font-size:16px}
.motif p{margin:0;color:var(--muted);font-size:13px}

/* decorative skyline (Singapore nod) */
.skyline{
  position:absolute;left:0;right:0;bottom:0;height:54px;background:
  linear-gradient(180deg, rgba(255,255,255,0), rgba(250,248,250,0.9));
  pointer-events:none;
}
.skyline svg{opacity:0.12;display:block;margin:0 auto;}

/* floating petal animation */
.petal{position:absolute;width:40px;height:40px;border-radius:50%;background:linear-gradient(180deg,#ffdfe8,#ffe8f0);opacity:0.95;filter:blur(.1px);pointer-events:none;animation:float 6s ease-in-out infinite}
.p1{left:8%;top:8%;animation-delay:0s}
.p2{left:22%;top:2%;animation-delay:1.2s}
.p3{left:46%;top:6%;animation-delay:.6s}
.p4{left:70%;top:12%;animation-delay:2s}
@keyframes float{0%{transform:translateY(0) rotate(0)}50%{transform:translateY(-12px) rotate(8deg)}100%{transform:translateY(0) rotate(0)}}

/* responsive */
@media (max-width:520px){
  .stone-box{width:110px;height:110px}
  .stone-core{width:72px;height:72px;font-size:22px}
  .grid{grid-template-columns:1fr}
  .aside{order:2}
}
</style>
</head>
<body>
  <div class="wrap" role="main">
    <div class="header-strip" aria-hidden="true"></div>

    <!-- orchid petal ornament -->
    <svg class="orchid" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <g fill="#f0c6b8"><path d="M100 2 L116 40 L158 44 L126 70 L136 110 L100 90 L64 110 L74 70 L42 44 L84 40 Z"/></g>
    </svg>

    <div class="header">
      <div class="logo">ॐ</div>
      <div class="title">
        <h1>Daily Oracle</h1>
        <p>Indo-Western • Singapore nature • handcrafted reveals</p>
      </div>
    </div>

    <div class="grid">
      <!-- left -->
      <div class="card">
        <div class="stone-row">
          <div class="stone-box" aria-hidden="true"><div class="stone-core">ॐ</div></div>

          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:start;gap:12px;flex-wrap:wrap">
              <div>
                <div style="font-weight:800;color:var(--ink);font-size:16px">Your personal Daily Oracle</div>
                <div style="color:var(--muted);font-size:13px;margin-top:6px">Tap your Blessing Stone or press Reveal: each draw is from your curated library of reveals (text, poem, fortune, quote, memory, image, audio).</div>
              </div>

              <div class="controls">
                <button id="reveal" class="btn">Reveal</button>
                <button id="newOne" class="btn ghost">Another</button>
                <button id="last" class="btn ghost">Show last</button>
              </div>
            </div>

            <div id="result" aria-live="polite">
              <div id="contentArea"><p style="color:var(--muted)">Tap <strong>Reveal</strong> to draw a blessing from the Daily Oracle.</p></div>
            </div>

            <div style="margin-top:10px;color:var(--muted);font-size:13px">Tip: audio needs a tap to play on phones. Edit reveals in <code>docs/data/blessings.json</code>.</div>
          </div>
        </div>
      </div>

      <!-- right -->
      <aside class="aside">
        <div class="motif">
          <h3>Design accents</h3>
          <p>Orchid petal ornament, gold foil highlight, batik texture and a subtle skyline echo of Singapore — woven together in a warm, cute palette.</p>
        </div>

        <div class="motif">
          <h3>Content scale</h3>
          <p>Reveals are loaded from <code>docs/data/blessings.json</code>. I can generate 800+ items for you and paste them directly into that file.</p>
        </div>

        <div class="motif" style="text-align:center">
          <h3>Site URL</h3>
          <div id="siteurl" style="font-weight:700;color:var(--ink);margin-top:8px"></div>
          <div style="color:var(--muted);font-size:13px;margin-top:8px">Use this URL for NFC tags.</div>
        </div>
      </aside>
    </div>

    <footer style="text-align:center;margin-top:12px;color:var(--muted)">Made with care — Daily Oracle</footer>

    <!-- skyline at bottom -->
    <div class="skyline" aria-hidden="true">
      <svg viewBox="0 0 800 54" xmlns="http://www.w3.org/2000/svg">
        <g fill="#2b2350"><rect x="30" y="20" width="6" height="22"/><rect x="52" y="8" width="8" height="34"/><rect x="72" y="14" width="6" height="28"/><rect x="92" y="2" width="12" height="40"/><rect x="114" y="18" width="6" height="24"/></g>
      </svg>
    </div>

    <!-- floating petals -->
    <div class="petal p1"></div><div class="petal p2"></div><div class="petal p3"></div><div class="petal p4"></div>

  </div>

<!-- SCRIPT: loads external JSON of reveals -->
<script>
const DATA_URL = './data/blessings.json';
let items = []; let lastIdx = null;

async function loadData(){
  try{
    const res = await fetch(DATA_URL + '?v=' + Date.now());
    if(!res.ok) throw new Error('Data not found: ' + res.status);
    items = await res.json();
    console.log('Loaded', items.length, 'reveals');
  } catch(e){
    console.error(e);
    document.getElementById('contentArea').innerHTML = '<p style="color:#b44">Could not load reveals. Create docs/data/blessings.json</p>';
  }
}
function pickRandomIdx(last){
  if(!items || items.length===0) return -1;
  if(items.length===1) return 0;
  let i; do { i = Math.floor(Math.random()*items.length); } while(i===last);
  return i;
}
function renderItem(i){
  const box = document.getElementById('contentArea'); box.innerHTML='';
  if(i<0){ box.innerHTML = '<p style="color:var(--muted)">No reveals yet — add items to docs/data/blessings.json</p>'; return; }
  const it = items[i];
  if(!it){ box.innerHTML = '<p style="color:var(--muted)">Invalid item</p>'; return; }

  if(it.type === 'audio'){
    const t = document.createElement('div'); t.className='meta'; t.innerText = it.label || 'Audio Blessing';
    const audio = document.createElement('audio'); audio.controls=true; audio.src = it.src; audio.setAttribute('playsinline',''); audio.setAttribute('preload','none');
    box.appendChild(t); box.appendChild(audio);
    const hint = document.createElement('div'); hint.className='meta'; hint.innerText='Tap play to listen.'; box.appendChild(hint);
  } else if(it.type === 'image'){
    const img = document.createElement('img'); img.src = it.src; img.alt = it.label||'image'; img.style.maxWidth='92%'; img.style.borderRadius='10px';
    box.appendChild(img);
    if(it.label){ const cap=document.createElement('div'); cap.className='meta'; cap.innerText=it.label; box.appendChild(cap); }
  } else {
    const p = document.createElement('div'); p.className='blessing'; p.innerText = it.content || it.text || '';
    box.appendChild(p);
    const meta = document.createElement('div'); meta.className='meta'; meta.innerText = (it.type || 'Text').charAt(0).toUpperCase() + (it.type || 'Text').slice(1);
    box.appendChild(meta);
  }
}

document.getElementById('reveal').addEventListener('click', ()=>{
  const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
});
document.getElementById('newOne').addEventListener('click', ()=>{
  const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
});
document.getElementById('last').addEventListener('click', ()=>{ if(lastIdx!==null) renderItem(lastIdx); });

(function(){ const site = location.origin + location.pathname.replace(/\/index\.html$/,''); document.getElementById('siteurl').innerText = site; })();

loadData();
</script>
</body>
</html>
