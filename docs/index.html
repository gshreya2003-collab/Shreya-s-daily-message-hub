<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daily Oracle — Blessing Stone</title>

  <!-- Cute friendly fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
  :root{
    --bg1: #fffcfb;
    --petal:#ffdfe8;    /* soft pink petal */
    --mint:#daf6ea;     /* mint */
    --lilac:#f5e9ff;    /* lilac */
    --saffron:#f2a65a;  /* warm accent */
    --ink:#2a2540;
    --muted:#837a8a;
    --card:#ffffff;
    --glass: rgba(255,255,255,0.75);
    --shadow: 0 18px 40px rgba(40,30,70,0.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    background:
      radial-gradient(circle at 10% 10%, #fffaf6 0%, #fbf8ff 35%),
      linear-gradient(180deg, rgba(250,245,250,0.02), rgba(245,244,250,0.02));
    font-family: "Nunito", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:var(--ink);
    padding:22px;
    display:flex;align-items:center;justify-content:center;
  }

  /* main wrapper */
  .wrap{
    width:100%; max-width:980px; border-radius:18px; padding:22px;
    background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.98));
    box-shadow:var(--shadow); border:1px solid rgba(60,40,80,0.03);
    position:relative; overflow:hidden;
  }

  /* soft decorative corners (orchid petals) */
  .corner {
    position:absolute; right:-40px; top:-40px; width:260px; opacity:0.08; transform:rotate(10deg);
  }
  .bottom-strip {
    position:absolute; left:0; right:0; bottom:0; height:42px;
    background: linear-gradient(180deg, rgba(255,255,255,0), rgba(245,244,250,0.7));
    pointer-events:none;
  }

  header{display:flex;gap:14px;align-items:center;margin-bottom:10px}
  .logo{
    width:68px;height:68px;border-radius:14px;display:flex;align-items:center;justify-content:center;
    background:linear-gradient(180deg,#fffefc,#fff6fb); font-family:"Merriweather", serif;
    color:var(--saffron); font-size:30px; box-shadow: inset 0 -8px 20px rgba(0,0,0,0.03)
  }
  h1{margin:0;font-size:22px;color:var(--ink);font-weight:700}
  p.lead{margin:0;color:var(--muted);font-size:13px}

  /* grid */
  .grid{display:grid;grid-template-columns:1fr 320px;gap:18px;align-items:start}
  @media (max-width:880px){.grid{grid-template-columns:1fr}}

  .card{background:var(--card);border-radius:14px;padding:14px;border:1px solid rgba(120,100,160,0.02);box-shadow:0 8px 28px rgba(20,15,40,0.03)}

  /* left primary area */
  .stone-row{display:flex;gap:14px;align-items:flex-start}
  .stone-box{width:140px;height:140px;border-radius:18px;background:linear-gradient(180deg,#fff,#fcf8ff);display:flex;align-items:center;justify-content:center;box-shadow:0 12px 30px rgba(40,30,60,0.06)}
  .stone-core{width:96px;height:96px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:"Merriweather",serif;color:var(--saffron);font-weight:700;font-size:28px;background:linear-gradient(180deg,#fff6ef,#fff0e6);box-shadow:inset 0 -8px 18px rgba(0,0,0,0.03)}

  .meta-line{color:var(--muted);font-size:13px;margin-top:6px}

  .controls{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
  .btn{
    background:linear-gradient(180deg,var(--saffron),#e07f3a);
    color:white;border:0;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 10px 30px rgba(200,90,30,0.12);
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .btn:hover{transform:translateY(-3px)}
  .btn.secondary{background:transparent;color:var(--ink);border:1px solid rgba(40,30,60,0.06);box-shadow:none;font-weight:600}

  #result{margin-top:14px;min-height:190px;padding:16px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffdfc);border:1px solid rgba(200,180,220,0.04);display:flex;align-items:center;justify-content:center;flex-direction:column}
  .blessing{font-family:"Merriweather",serif;color:var(--deep);font-size:20px;line-height:1.5;text-align:center;margin:0;padding:0 12px;white-space:pre-wrap}
  .tiny-meta{margin-top:12px;color:var(--muted);font-size:13px}

  /* cute floating petals */
  .petal { position:absolute; width:36px; height:36px; border-radius:50%; background:var(--petal); opacity:0.9; filter:blur(.2px); transform-origin:center; animation: floaty 6s infinite ease-in-out; pointer-events:none }
  .petal.p1{left:10%; top:8%; animation-delay:0s}
  .petal.p2{left:25%; top:2%; animation-delay:1.5s}
  .petal.p3{left:40%; top:6%; animation-delay:.7s}
  .petal.p4{left:70%; top:12%; animation-delay:2s}
  .petal.p5{left:84%; top:4%; animation-delay:3s}

  @keyframes floaty{0%{transform:translateY(0) rotate(0)}50%{transform:translateY(-10px) rotate(8deg)}100%{transform:translateY(0) rotate(0)}}

  /* right column */
  .aside { display:flex;flex-direction:column;gap:12px }
  .motif h3{margin:0 0 8px 0;color:var(--ink)}
  .motif p{margin:0;color:var(--muted);font-size:13px}
  .preview-img{width:100%;border-radius:10px;display:block;margin-top:10px;object-fit:cover;height:140px}

  footer{text-align:center;margin-top:14px;color:var(--muted);font-size:13px}

  /* responsive safety */
  @media (max-width:520px){
    .stone-box{width:110px;height:110px}
    .stone-core{width:70px;height:70px;font-size:20px}
    .btn{padding:8px 10px}
  }
  </style>
</head>
<body>
  <div class="wrap" role="main" aria-live="polite">
    <!-- decorative -->
    <svg class="corner" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <g fill="#dba6b8"><path d="M100 2 L116 40 L158 44 L126 70 L136 110 L100 90 L64 110 L74 70 L42 44 L84 40 Z"/></g>
    </svg>

    <header>
      <div class="logo">ॐ</div>
      <div>
        <h1>Daily Oracle</h1>
        <p class="lead">Cute, cozy, and handcrafted — tap your Blessing Stone or press Reveal for a random blessing.</p>
      </div>
    </header>

    <div class="grid">
      <!-- left -->
      <div class="card">
        <div class="stone-row">
          <div class="stone-box" aria-hidden="true"><div class="stone-core">ॐ</div></div>

          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap">
              <div>
                <div style="font-weight:800;color:var(--ink)">Your Daily Oracle</div>
                <div class="meta-line">Handmade reveals: fortunes, poems, memories, audio & images.</div>
              </div>

              <div style="display:flex;gap:8px">
                <button id="reveal" class="btn">Reveal</button>
                <button id="newOne" class="btn secondary">Another</button>
                <button id="last" class="btn secondary">Show last</button>
              </div>
            </div>

            <div id="result">
              <div id="contentArea"><p style="color:var(--muted)">Tap Reveal to draw from your curated collection.</p></div>
            </div>

            <div class="tiny-meta">Tip: audio needs a tap to play on phones. To edit reveals, update <code>docs/data/blessings.json</code>.</div>
          </div>
        </div>
      </div>

      <!-- right -->
      <aside class="aside">
        <div class="card motif">
          <h3>Design accents</h3>
          <p>Pastel petals, orchid ornament, batik texture, and a friendly skyline — a soft Indo-Western + Singapore nature palette.</p>
          <div style="display:flex;gap:8px;align-items:center;margin-top:10px">
            <!-- small orchid -->
            <svg width="44" height="44" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="#f08f72" d="M12 2s2.5 2 3 4c0 0 1.8 0 2 1s-1 1-1 1 1 1 1 2-1 1-1 1-1.2 0-2 1-1.5 3-2.5 3-1.5-1.5-2-2-1.3-1-2-1-1 1-2 1-1.2-3-2.5-3-2 0-2-1 1-2 1-2-1-1-1-1 1-1 2-1 2 1 2 1 1-2 3-4 3 0 3 0z"/></svg>
            <!-- skyline -->
            <svg width="76" height="44" viewBox="0 0 80 24" xmlns="http://www.w3.org/2000/svg"><g fill="#2b2350"><rect x="2" y="8" width="4" height="12"/><rect x="8" y="4" width="3" height="16"/><rect x="12" y="10" width="3" height="10"/><rect x="16" y="2" width="4" height="18"/><rect x="22" y="12" width="3" height="8"/></g></svg>
          </div>
        </div>

        <div class="card motif">
          <h3>Content & scale</h3>
          <p>Reveals live in <code>docs/data/blessings.json</code>. I can generate 800+ items for you (fortunes/poems/quotes/memories & placeholders for audio/images).</p>
        </div>

        <div class="card motif" style="text-align:center">
          <h3>Site URL</h3>
          <div id="siteurl" style="font-weight:800;color:var(--ink);margin-top:8px"></div>
          <div style="color:var(--muted);font-size:13px;margin-top:6px">Use this as the URL to write to your NFC tags.</div>
        </div>
      </aside>
    </div>

    <footer style="margin-top:12px">Made with <span style="color:#f08f72">♡</span> — Daily Oracle</footer>

    <div class="bottom-strip"></div>

    <!-- floating petals (for cute look) -->
    <div class="petal p1" style="border-radius:18px; transform:rotate(-20deg)"></div>
    <div class="petal p2" style="border-radius:16px; transform:rotate(10deg)"></div>
    <div class="petal p3" style="border-radius:20px; transform:rotate(40deg)"></div>
    <div class="petal p4" style="border-radius:18px; transform:rotate(-10deg)"></div>
    <div class="petal p5" style="border-radius:16px; transform:rotate(6deg)"></div>
  </div>

  <script>
  // DATA URL (relative path to JSON file)
  const DATA_URL = './data/blessings.json';

  let items = [];
  let lastIdx = null;

  async function loadData(){
    try {
      const res = await fetch(DATA_URL + '?v=' + (Date.now()));
      if(!res.ok) throw new Error('Could not load blessings JSON: ' + res.status);
      items = await res.json();
      console.log('Daily Oracle loaded', items.length, 'items');
      // optionally show a random one automatically:
      // revealRandom();
    } catch (e) {
      console.error(e);
      document.getElementById('contentArea').innerHTML = '<p style="color:#b44">Could not load reveals. Create docs/data/blessings.json</p>';
    }
  }

  function pickRandomIdx(last){
    if(!items || items.length === 0) return -1;
    if(items.length === 1) return 0;
    let i;
    do { i = Math.floor(Math.random()*items.length); } while(items.length>1 && i === last);
    return i;
  }

  function renderItem(i){
    const box = document.getElementById('contentArea');
    box.innerHTML = '';
    if(i < 0){ box.innerHTML = '<p style="color:var(--muted)">No reveals yet — add items to docs/data/blessings.json</p>'; return; }
    const it = items[i];
    if(!it){ box.innerHTML = '<p style="color:var(--muted)">Invalid item</p>'; return; }

    if(it.type === 'audio'){
      const t = document.createElement('div'); t.className='tiny-meta'; t.innerText = it.label || 'Audio Blessing';
      const audio = document.createElement('audio'); audio.controls=true; audio.src=it.src; audio.setAttribute('playsinline',''); audio.setAttribute('preload','none');
      box.appendChild(t); box.appendChild(audio);
      const hint = document.createElement('div'); hint.className='tiny-meta'; hint.innerText = 'Tap play to listen.'; box.appendChild(hint);
    } else if(it.type === 'image'){
      const img = document.createElement('img'); img.src = it.src; img.alt = it.label || 'image'; img.style.maxWidth='92%'; img.style.borderRadius='10px';
      box.appendChild(img);
      if(it.label){ const cap = document.createElement('div'); cap.className='tiny-meta'; cap.innerText = it.label; box.appendChild(cap); }
    } else {
      const p = document.createElement('div'); p.className='blessing'; p.innerText = it.content || it.text || '';
      box.appendChild(p);
      const meta = document.createElement('div'); meta.className='tiny-meta'; meta.innerText = (it.type || 'Text').charAt(0).toUpperCase() + (it.type || 'Text').slice(1);
      box.appendChild(meta);
    }
  }

  document.getElementById('reveal').addEventListener('click', ()=>{
    const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
  });
  document.getElementById('newOne').addEventListener('click', ()=>{
    const idx = pickRandomIdx(lastIdx); lastIdx = idx; renderItem(idx);
  });
  document.getElementById('last').addEventListener('click', ()=>{ if(lastIdx !== null) renderItem(lastIdx); });

  // show site url for NFC programming
  (function(){ const site = location.origin + location.pathname.replace(/\/index\.html$/,''); document.getElementById('siteurl').innerText = site; })();

  // load data
  loadData();
  </script>
</body>
</html>
